<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RuyaTracker CLM Enterprise</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        /* Login Page Styles */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-logo {
            width: 120px;
            height: auto;
            margin-bottom: 20px;
        }

        .login-title {
            font-size: 28px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .login-btn:hover {
            transform: translateY(-2px);
        }

        .demo-credentials {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 14px;
            color: #6c757d;
        }

        .demo-credentials strong {
            color: #495057;
        }

        /* Main App Styles */
        .app-container {
            display: none;
            min-height: 100vh;
            background: #f5f6fa;
        }

        .app-header {
            background: white;
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .app-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .app-logo img {
            width: 40px;
            height: 40px;
        }

        .app-logo h1 {
            font-size: 24px;
            color: #2c3e50;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .logout-btn {
            padding: 8px 16px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .logout-btn:hover {
            background: #c0392b;
        }

        .app-main {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            width: 250px;
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            padding: 20px 0;
        }

        .nav-item {
            padding: 15px 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .nav-item:hover {
            background: #f8f9fa;
            border-left-color: #667eea;
        }

        .nav-item.active {
            background: #667eea;
            color: white;
            border-left-color: #764ba2;
        }

        .nav-item i {
            margin-right: 10px;
            width: 20px;
        }

        .content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-title {
            font-size: 28px;
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        /* Dashboard Styles */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
        }

        .kpi-value {
            font-size: 36px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .kpi-label {
            color: #7f8c8d;
            font-size: 16px;
        }

        .kpi-trend {
            margin-top: 10px;
            font-size: 14px;
        }

        .trend-up {
            color: #27ae60;
        }

        .trend-down {
            color: #e74c3c;
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Pending Approvals */
        .pending-approvals {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .approval-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        .approval-item:last-child {
            border-bottom: none;
        }

        .approval-info h4 {
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .approval-info p {
            color: #7f8c8d;
            font-size: 14px;
        }

        .approval-actions {
            display: flex;
            gap: 10px;
        }

        /* Tables */
        .table-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .table-header {
            padding: 20px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
        }

        .table-actions {
            display: flex;
            gap: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: #d5f4e6;
            color: #27ae60;
        }

        .status-pending {
            background: #fef9e7;
            color: #f39c12;
        }

        .status-draft {
            background: #eaecee;
            color: #95a5a6;
        }

        .status-approved {
            background: #d5f4e6;
            color: #27ae60;
        }

        .status-rejected {
            background: #fadbd8;
            color: #e74c3c;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #000;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid #ecf0f1;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-col {
            flex: 1;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
        }

        /* View Options */
        .view-options {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .view-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .view-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .view-btn:hover {
            background: #f8f9fa;
        }

        .view-btn.active:hover {
            background: #5a6fd8;
        }

        /* List and Card Views */
        .list-view, .card-view {
            display: none;
        }

        .list-view.active, .card-view.active {
            display: block;
        }

        .list-item {
            background: white;
            padding: 20px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .card-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .card-item:hover {
            transform: translateY(-5px);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-main {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                order: 2;
            }

            .content {
                order: 1;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                flex-direction: column;
            }
        }

        /* Activity Feed */
        .activity-feed {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 25px;
        }

        .activity-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #ecf0f1;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 16px;
        }

        .activity-icon.contract {
            background: #e8f4fd;
            color: #3498db;
        }

        .activity-icon.vendor {
            background: #fef9e7;
            color: #f39c12;
        }

        .activity-icon.workflow {
            background: #d5f4e6;
            color: #27ae60;
        }

        .activity-content h4 {
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .activity-content p {
            color: #7f8c8d;
            font-size: 14px;
        }

        .activity-time {
            margin-left: auto;
            color: #95a5a6;
            font-size: 12px;
        }

        /* Settings Tabs */
        .settings-tabs {
            display: flex;
            border-bottom: 1px solid #ecf0f1;
            margin-bottom: 20px;
            background: white;
            border-radius: 12px 12px 0 0;
            overflow: hidden;
        }

        .settings-tab {
            padding: 15px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            background: white;
        }

        .settings-tab:hover {
            background: #f8f9fa;
        }

        .settings-tab.active {
            border-bottom-color: #667eea;
            background: #f8f9fa;
        }

        .settings-content {
            background: white;
            padding: 25px;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .settings-section {
            display: none;
        }

        .settings-section.active {
            display: block;
        }

        .settings-group {
            margin-bottom: 30px;
        }

        .settings-group h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #ecf0f1;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-info h4 {
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .setting-info p {
            color: #7f8c8d;
            font-size: 14px;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: #ccc;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: #667eea;
        }

        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(26px);
        }

        /* Approval Indicators */
        .approval-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .approval-indicator.procurement {
            background: #fef9e7;
            color: #f39c12;
        }

        .approval-indicator.approved {
            background: #d5f4e6;
            color: #27ae60;
        }

        .approval-indicator.rejected {
            background: #fadbd8;
            color: #e74c3c;
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
        }

        /* Loading States */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Success/Error Messages */
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            font-weight: 500;
        }

        .alert-success {
            background: #d5f4e6;
            color: #27ae60;
            border: 1px solid #27ae60;
        }

        .alert-error {
            background: #fadbd8;
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }

        .alert-warning {
            background: #fef9e7;
            color: #f39c12;
            border: 1px solid #f39c12;
        }

        .alert-info {
            background: #e8f4fd;
            color: #3498db;
            border: 1px solid #3498db;
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container">
        <div class="login-card">
            <svg class="login-logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="url(#gradient)" />
                <text x="50" y="60" text-anchor="middle" fill="white" font-size="24" font-weight="bold">R</text>
                <defs>
                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#667eea" />
                        <stop offset="100%" style="stop-color:#764ba2" />
                    </linearGradient>
                </defs>
            </svg>
            
            <h1 class="login-title">RuyaTracker CLM</h1>
            <p class="login-subtitle">Enterprise Contract Lifecycle Management</p>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required>
                </div>
                
                <button type="submit" class="login-btn">Sign In</button>
            </form>
            
            <div class="demo-credentials">
                <strong>Demo Credentials:</strong><br>
                <strong>Admin:</strong> admin@ruyatrack.com / admin123<br>
                <strong>Manager:</strong> manager@ruyatrack.com / manager123<br>
                <strong>Procurement:</strong> procurement@ruyatrack.com / proc123<br>
                <strong>Finance:</strong> finance@ruyatrack.com / fin123
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="appContainer" class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="app-logo">
                <svg width="40" height="40" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="45" fill="url(#headerGradient)" />
                    <text x="50" y="60" text-anchor="middle" fill="white" font-size="24" font-weight="bold">R</text>
                    <defs>
                        <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#667eea" />
                            <stop offset="100%" style="stop-color:#764ba2" />
                        </linearGradient>
                    </defs>
                </svg>
                <h1>RuyaTracker CLM Enterprise</h1>
            </div>
            
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">A</div>
                <span id="userName">Administrator</span>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </header>

        <div class="app-main">
            <!-- Sidebar -->
            <nav class="sidebar">
                <div class="nav-item active" onclick="showSection('dashboard')">
                    <i>📊</i> Dashboard
                </div>
                <div class="nav-item" onclick="showSection('contracts')">
                    <i>📄</i> Contracts
                </div>
                <div class="nav-item" onclick="showSection('vendors')">
                    <i>🏢</i> Vendors
                </div>
                <div class="nav-item" onclick="showSection('workflows')">
                    <i>⚡</i> Workflows
                </div>
                <div class="nav-item" onclick="showSection('analytics')">
                    <i>📈</i> Analytics
                </div>
                <div class="nav-item" onclick="showSection('users')">
                    <i>👥</i> Users
                </div>
                <div class="nav-item" onclick="showSection('settings')">
                    <i>⚙️</i> Settings
                </div>
            </nav>

            <!-- Main Content -->
            <main class="content">
                <!-- Dashboard Section -->
                <section id="dashboard" class="section active">
                    <h2 class="section-title">
                        <i>📊</i> Dashboard
                    </h2>

                    <!-- KPI Cards -->
                    <div class="dashboard-grid">
                        <div class="kpi-card">
                            <div class="kpi-value" id="totalContracts">12</div>
                            <div class="kpi-label">Total Contracts</div>
                            <div class="kpi-trend trend-up">↗ +2 this month</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value" id="activeVendors">8</div>
                            <div class="kpi-label">Active Vendors</div>
                            <div class="kpi-trend trend-up">↗ +1 this month</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value" id="pendingApprovals">5</div>
                            <div class="kpi-label">Pending Approvals</div>
                            <div class="kpi-trend trend-down">↘ -2 this week</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-value" id="totalValue">2.4M</div>
                            <div class="kpi-label">Total Contract Value (SAR)</div>
                            <div class="kpi-trend trend-up">↗ +15% this quarter</div>
                        </div>
                    </div>

                    <!-- Pending Approvals Section -->
                    <div class="pending-approvals">
                        <h3 style="margin-bottom: 20px; color: #2c3e50;">Pending Approvals</h3>
                        <div id="pendingApprovalsList">
                            <!-- Pending approvals will be populated here -->
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="chart-card">
                            <h3 class="chart-title">Contract Value Distribution</h3>
                            <div class="chart-container">
                                <svg width="300" height="300" id="contractValueChart"></svg>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h3 class="chart-title">Vendor Performance</h3>
                            <div class="chart-container">
                                <svg width="300" height="250" id="vendorPerformanceChart"></svg>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h3 class="chart-title">Contract Status Overview</h3>
                            <div class="chart-container">
                                <svg width="300" height="300" id="contractStatusChart"></svg>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h3 class="chart-title">Monthly Contract Trends</h3>
                            <div class="chart-container">
                                <svg width="350" height="250" id="monthlyTrendsChart"></svg>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="activity-feed">
                        <h3 style="margin-bottom: 20px; color: #2c3e50;">Recent Activity</h3>
                        <div id="activityFeed">
                            <!-- Activity items will be populated here -->
                        </div>
                    </div>
                </section>

                <!-- Contracts Section -->
                <section id="contracts" class="section">
                    <h2 class="section-title">
                        <i>📄</i> Contracts
                    </h2>

                    <div class="table-container">
                        <div class="table-header">
                            <h3 class="table-title">Contract Management</h3>
                            <div class="table-actions">
                                <button class="btn btn-primary" onclick="openAddContractModal()">
                                    <i>➕</i> Add Contract
                                </button>
                                <button class="btn btn-secondary" onclick="generateContractReport()">
                                    <i>📊</i> Generate Report
                                </button>
                            </div>
                        </div>
                        
                        <table id="contractsTable">
                            <thead>
                                <tr>
                                    <th>Contract ID</th>
                                    <th>Title</th>
                                    <th>Vendor</th>
                                    <th>Value (SAR)</th>
                                    <th>Status</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="contractsTableBody">
                                <!-- Contract rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Vendors Section -->
                <section id="vendors" class="section">
                    <h2 class="section-title">
                        <i>🏢</i> Vendors
                    </h2>

                    <div class="table-container">
                        <div class="table-header">
                            <h3 class="table-title">Vendor Management</h3>
                            <div class="table-actions">
                                <div class="view-options">
                                    <button class="view-btn active" onclick="switchVendorView('table')">Table</button>
                                    <button class="view-btn" onclick="switchVendorView('list')">List</button>
                                    <button class="view-btn" onclick="switchVendorView('cards')">Cards</button>
                                </div>
                                <button class="btn btn-primary" onclick="openAddVendorModal()">
                                    <i>➕</i> Add Vendor
                                </button>
                            </div>
                        </div>

                        <!-- Table View -->
                        <div id="vendorTableView" class="vendor-view active">
                            <table id="vendorsTable">
                                <thead>
                                    <tr>
                                        <th>Vendor ID</th>
                                        <th>Name</th>
                                        <th>Contact</th>
                                        <th>Email</th>
                                        <th>Category</th>
                                        <th>Rating</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="vendorsTableBody">
                                    <!-- Vendor rows will be populated here -->
                                </tbody>
                            </table>
                        </div>

                        <!-- List View -->
                        <div id="vendorListView" class="vendor-view list-view">
                            <div id="vendorsList">
                                <!-- Vendor list items will be populated here -->
                            </div>
                        </div>

                        <!-- Card View -->
                        <div id="vendorCardView" class="vendor-view card-view">
                            <div class="card-grid" id="vendorsCards">
                                <!-- Vendor cards will be populated here -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Workflows Section -->
                <section id="workflows" class="section">
                    <h2 class="section-title">
                        <i>⚡</i> Workflows
                    </h2>

                    <div class="table-container">
                        <div class="table-header">
                            <h3 class="table-title">Workflow Management</h3>
                            <div class="table-actions">
                                <button class="btn btn-primary" onclick="openAddWorkflowModal()">
                                    <i>➕</i> Create Workflow
                                </button>
                            </div>
                        </div>
                        
                        <table id="workflowsTable">
                            <thead>
                                <tr>
                                    <th>Workflow ID</th>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Status</th>
                                    <th>Assigned To</th>
                                    <th>Created Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="workflowsTableBody">
                                <!-- Workflow rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Analytics Section -->
                <section id="analytics" class="section">
                    <h2 class="section-title">
                        <i>📈</i> Analytics & Reports
                    </h2>

                    <div class="charts-grid">
                        <div class="chart-card">
                            <h3 class="chart-title">Financial Overview</h3>
                            <div class="chart-container">
                                <svg width="350" height="250" id="financialChart"></svg>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h3 class="chart-title">Workflow Status Distribution</h3>
                            <div class="chart-container">
                                <svg width="300" height="300" id="workflowStatusChart"></svg>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h3 class="chart-title">Vendor Category Distribution</h3>
                            <div class="chart-container">
                                <svg width="300" height="300" id="vendorCategoryChart"></svg>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h3 class="chart-title">Contract Performance Metrics</h3>
                            <div class="chart-container">
                                <svg width="350" height="250" id="performanceChart"></svg>
                            </div>
                        </div>
                    </div>

                    <div class="table-container" style="margin-top: 30px;">
                        <div class="table-header">
                            <h3 class="table-title">Export Reports</h3>
                            <div class="table-actions">
                                <button class="btn btn-success" onclick="exportReport('pdf')">
                                    <i>📄</i> Export PDF
                                </button>
                                <button class="btn btn-success" onclick="exportReport('excel')">
                                    <i>📊</i> Export Excel
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Users Section -->
                <section id="users" class="section">
                    <h2 class="section-title">
                        <i>👥</i> User Management
                    </h2>

                    <div class="table-container">
                        <div class="table-header">
                            <h3 class="table-title">System Users</h3>
                            <div class="table-actions">
                                <button class="btn btn-primary" onclick="openAddUserModal()">
                                    <i>➕</i> Add User
                                </button>
                            </div>
                        </div>
                        
                        <table id="usersTable">
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Department</th>
                                    <th>Status</th>
                                    <th>Last Login</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- User rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settings" class="section">
                    <h2 class="section-title">
                        <i>⚙️</i> System Settings
                    </h2>

                    <div class="settings-tabs">
                        <div class="settings-tab active" onclick="showSettingsTab('general')">General</div>
                        <div class="settings-tab" onclick="showSettingsTab('audit')">Audit Trail</div>
                        <div class="settings-tab" onclick="showSettingsTab('notifications')">Notifications</div>
                        <div class="settings-tab" onclick="showSettingsTab('integrations')">Integrations</div>
                        <div class="settings-tab" onclick="showSettingsTab('security')">Security</div>
                        <div class="settings-tab" onclick="showSettingsTab('backup')">Backup & Recovery</div>
                    </div>

                    <div class="settings-content">
                        <!-- General Settings -->
                        <div id="generalSettings" class="settings-section active">
                            <div class="settings-group">
                                <h3>System Configuration</h3>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>System Name</h4>
                                        <p>Display name for the CLM system</p>
                                    </div>
                                    <input type="text" class="form-control" value="RuyaTracker CLM Enterprise" style="width: 250px;">
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Default Currency</h4>
                                        <p>Primary currency for contract values</p>
                                    </div>
                                    <select class="form-control" style="width: 150px;">
                                        <option value="SAR" selected>SAR (Saudi Riyal)</option>
                                        <option value="USD">USD (US Dollar)</option>
                                        <option value="EUR">EUR (Euro)</option>
                                    </select>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Date Format</h4>
                                        <p>System-wide date display format</p>
                                    </div>
                                    <select class="form-control" style="width: 150px;">
                                        <option value="DD/MM/YYYY" selected>DD/MM/YYYY</option>
                                        <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                        <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                    </select>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Timezone</h4>
                                        <p>System timezone for all operations</p>
                                    </div>
                                    <select class="form-control" style="width: 200px;">
                                        <option value="Asia/Riyadh" selected>Asia/Riyadh (GMT+3)</option>
                                        <option value="UTC">UTC (GMT+0)</option>
                                        <option value="America/New_York">America/New_York (GMT-5)</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Audit Trail Settings -->
                        <div id="auditSettings" class="settings-section">
                            <div class="settings-group">
                                <h3>Audit Configuration</h3>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Enable Audit Logging</h4>
                                        <p>Track all user actions and system changes</p>
                                    </div>
                                    <div class="toggle-switch active" onclick="toggleSetting(this)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Retention Period</h4>
                                        <p>How long to keep audit logs</p>
                                    </div>
                                    <select class="form-control" style="width: 150px;">
                                        <option value="90">90 days</option>
                                        <option value="180">180 days</option>
                                        <option value="365" selected>1 year</option>
                                        <option value="1095">3 years</option>
                                        <option value="1825">5 years</option>
                                    </select>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Export Audit Logs</h4>
                                        <p>Download audit trail reports</p>
                                    </div>
                                    <button class="btn btn-secondary" onclick="exportAuditLogs()">Export Logs</button>
                                </div>
                            </div>
                        </div>

                        <!-- Notification Settings -->
                        <div id="notificationSettings" class="settings-section">
                            <div class="settings-group">
                                <h3>Email Notifications</h3>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>SMTP Server</h4>
                                        <p>Email server configuration</p>
                                    </div>
                                    <input type="text" class="form-control" value="smtp.ruyatrack.com" style="width: 200px;">
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>SMTP Port</h4>
                                        <p>Email server port</p>
                                    </div>
                                    <input type="number" class="form-control" value="587" style="width: 100px;">
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Contract Approval Notifications</h4>
                                        <p>Send emails for contract approvals</p>
                                    </div>
                                    <div class="toggle-switch active" onclick="toggleSetting(this)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Vendor Approval Notifications</h4>
                                        <p>Send emails for vendor approvals</p>
                                    </div>
                                    <div class="toggle-switch active" onclick="toggleSetting(this)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Integration Settings -->
                        <div id="integrationSettings" class="settings-section">
                            <div class="settings-group">
                                <h3>System Integrations</h3>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Active Directory Integration</h4>
                                        <p>Connect with corporate AD for user authentication</p>
                                    </div>
                                    <div class="toggle-switch" onclick="toggleSetting(this)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>ERP Integration</h4>
                                        <p>Sync with enterprise resource planning system</p>
                                    </div>
                                    <div class="toggle-switch" onclick="toggleSetting(this)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>API Access</h4>
                                        <p>Enable REST API for third-party integrations</p>
                                    </div>
                                    <div class="toggle-switch active" onclick="toggleSetting(this)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Test Integration</h4>
                                        <p>Test connectivity with external systems</p>
                                    </div>
                                    <button class="btn btn-secondary" onclick="testIntegration()">Test Connection</button>
                                </div>
                            </div>
                        </div>

                        <!-- Security Settings -->
                        <div id="securitySettings" class="settings-section">
                            <div class="settings-group">
                                <h3>Security Configuration</h3>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Two-Factor Authentication</h4>
                                        <p>Require 2FA for all users</p>
                                    </div>
                                    <div class="toggle-switch" onclick="toggleSetting(this)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Password Policy</h4>
                                        <p>Enforce strong password requirements</p>
                                    </div>
                                    <div class="toggle-switch active" onclick="toggleSetting(this)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Session Timeout</h4>
                                        <p>Automatic logout after inactivity</p>
                                    </div>
                                    <select class="form-control" style="width: 150px;">
                                        <option value="15">15 minutes</option>
                                        <option value="30" selected>30 minutes</option>
                                        <option value="60">1 hour</option>
                                        <option value="120">2 hours</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Backup Settings -->
                        <div id="backupSettings" class="settings-section">
                            <div class="settings-group">
                                <h3>Backup Configuration</h3>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Automatic Backups</h4>
                                        <p>Schedule regular system backups</p>
                                    </div>
                                    <div class="toggle-switch active" onclick="toggleSetting(this)">
                                        <div class="toggle-slider"></div>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Backup Frequency</h4>
                                        <p>How often to create backups</p>
                                    </div>
                                    <select class="form-control" style="width: 150px;">
                                        <option value="daily" selected>Daily</option>
                                        <option value="weekly">Weekly</option>
                                        <option value="monthly">Monthly</option>
                                    </select>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Create Manual Backup</h4>
                                        <p>Generate backup now</p>
                                    </div>
                                    <button class="btn btn-secondary" onclick="createBackup()">Create Backup</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Add Contract Modal -->
    <div id="addContractModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Contract</h3>
                <span class="close" onclick="closeModal('addContractModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addContractForm">
                    <div class="form-row">
                        <div class="form-col">
                            <label>Contract Title</label>
                            <input type="text" class="form-control" name="title" required>
                        </div>
                        <div class="form-col">
                            <label>Contract ID</label>
                            <input type="text" class="form-control" name="contractId" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Vendor</label>
                            <select class="form-control" name="vendor" required>
                                <option value="">Select Vendor</option>
                                <option value="Microsoft Corporation">Microsoft Corporation</option>
                                <option value="Oracle Systems">Oracle Systems</option>
                                <option value="SAP Solutions">SAP Solutions</option>
                                <option value="IBM Services">IBM Services</option>
                                <option value="Accenture">Accenture</option>
                                <option value="Deloitte">Deloitte</option>
                                <option value="KPMG">KPMG</option>
                                <option value="PwC">PwC</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label>Contract Value (SAR)</label>
                            <input type="number" class="form-control" name="value" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Start Date</label>
                            <input type="date" class="form-control" name="startDate" required>
                        </div>
                        <div class="form-col">
                            <label>End Date</label>
                            <input type="date" class="form-control" name="endDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Category</label>
                            <select class="form-control" name="category" required>
                                <option value="">Select Category</option>
                                <option value="Software License">Software License</option>
                                <option value="Professional Services">Professional Services</option>
                                <option value="Maintenance">Maintenance</option>
                                <option value="Consulting">Consulting</option>
                                <option value="Support">Support</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label>Priority</label>
                            <select class="form-control" name="priority" required>
                                <option value="Low">Low</option>
                                <option value="Medium" selected>Medium</option>
                                <option value="High">High</option>
                                <option value="Critical">Critical</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Description</label>
                            <textarea class="form-control" name="description" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Upload Contract Document</label>
                            <input type="file" class="form-control" name="document" accept=".pdf,.doc,.docx">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addContractModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveContract()">Save Contract</button>
            </div>
        </div>
    </div>

    <!-- View Contract Modal -->
    <div id="viewContractModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Contract Details</h3>
                <span class="close" onclick="closeModal('viewContractModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div id="contractDetails">
                    <!-- Contract details will be populated here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('viewContractModal')">Close</button>
                <button type="button" class="btn btn-warning" onclick="editContractFromView()">Edit</button>
            </div>
        </div>
    </div>

    <!-- Edit Contract Modal -->
    <div id="editContractModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Edit Contract</h3>
                <span class="close" onclick="closeModal('editContractModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="editContractForm">
                    <input type="hidden" name="id" id="editContractId">
                    <div class="form-row">
                        <div class="form-col">
                            <label>Contract Title</label>
                            <input type="text" class="form-control" name="title" id="editContractTitle" required>
                        </div>
                        <div class="form-col">
                            <label>Contract ID</label>
                            <input type="text" class="form-control" name="contractId" id="editContractContractId" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Vendor</label>
                            <select class="form-control" name="vendor" id="editContractVendor" required>
                                <option value="">Select Vendor</option>
                                <option value="Microsoft Corporation">Microsoft Corporation</option>
                                <option value="Oracle Systems">Oracle Systems</option>
                                <option value="SAP Solutions">SAP Solutions</option>
                                <option value="IBM Services">IBM Services</option>
                                <option value="Accenture">Accenture</option>
                                <option value="Deloitte">Deloitte</option>
                                <option value="KPMG">KPMG</option>
                                <option value="PwC">PwC</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label>Contract Value (SAR)</label>
                            <input type="number" class="form-control" name="value" id="editContractValue" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Start Date</label>
                            <input type="date" class="form-control" name="startDate" id="editContractStartDate" required>
                        </div>
                        <div class="form-col">
                            <label>End Date</label>
                            <input type="date" class="form-control" name="endDate" id="editContractEndDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Status</label>
                            <select class="form-control" name="status" id="editContractStatus" required>
                                <option value="Draft">Draft</option>
                                <option value="P1">P1 - Procurement Review</option>
                                <option value="P2">P2 - Manager Approval</option>
                                <option value="PF">PF - Final Approval</option>
                                <option value="Approved">Approved</option>
                                <option value="Rejected">Rejected</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label>Priority</label>
                            <select class="form-control" name="priority" id="editContractPriority" required>
                                <option value="Low">Low</option>
                                <option value="Medium">Medium</option>
                                <option value="High">High</option>
                                <option value="Critical">Critical</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Description</label>
                            <textarea class="form-control" name="description" id="editContractDescription" rows="3"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('editContractModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="updateContract()">Update Contract</button>
            </div>
        </div>
    </div>

    <!-- Add Vendor Modal -->
    <div id="addVendorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Vendor</h3>
                <span class="close" onclick="closeModal('addVendorModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addVendorForm">
                    <div class="form-row">
                        <div class="form-col">
                            <label>Vendor Name</label>
                            <input type="text" class="form-control" name="name" required>
                        </div>
                        <div class="form-col">
                            <label>Contact Person</label>
                            <input type="text" class="form-control" name="contact" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Email</label>
                            <input type="email" class="form-control" name="email" required>
                        </div>
                        <div class="form-col">
                            <label>Phone</label>
                            <input type="tel" class="form-control" name="phone" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Address</label>
                            <textarea class="form-control" name="address" rows="2"></textarea>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Category</label>
                            <select class="form-control" name="category" required>
                                <option value="">Select Category</option>
                                <option value="Technology">Technology</option>
                                <option value="Consulting">Consulting</option>
                                <option value="Professional Services">Professional Services</option>
                                <option value="Manufacturing">Manufacturing</option>
                                <option value="Logistics">Logistics</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label>Rating</label>
                            <select class="form-control" name="rating">
                                <option value="5">5 - Excellent</option>
                                <option value="4" selected>4 - Good</option>
                                <option value="3">3 - Average</option>
                                <option value="2">2 - Below Average</option>
                                <option value="1">1 - Poor</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Upload Documents (Optional)</label>
                            <input type="file" class="form-control" name="documents" multiple accept=".pdf,.doc,.docx,.txt,.jpg,.png">
                            <small style="color: #7f8c8d;">You can upload multiple files (PDF, DOC, images)</small>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addVendorModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveVendor()">Save Vendor</button>
            </div>
        </div>
    </div>

    <!-- View Vendor Modal -->
    <div id="viewVendorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Vendor Details</h3>
                <span class="close" onclick="closeModal('viewVendorModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div id="vendorDetails">
                    <!-- Vendor details will be populated here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('viewVendorModal')">Close</button>
                <button type="button" class="btn btn-warning" onclick="editVendorFromView()">Edit</button>
            </div>
        </div>
    </div>

    <!-- Edit Vendor Modal -->
    <div id="editVendorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Edit Vendor</h3>
                <span class="close" onclick="closeModal('editVendorModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="editVendorForm">
                    <input type="hidden" name="id" id="editVendorId">
                    <div class="form-row">
                        <div class="form-col">
                            <label>Vendor Name</label>
                            <input type="text" class="form-control" name="name" id="editVendorName" required>
                        </div>
                        <div class="form-col">
                            <label>Contact Person</label>
                            <input type="text" class="form-control" name="contact" id="editVendorContact" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Email</label>
                            <input type="email" class="form-control" name="email" id="editVendorEmail" required>
                        </div>
                        <div class="form-col">
                            <label>Phone</label>
                            <input type="tel" class="form-control" name="phone" id="editVendorPhone" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Address</label>
                            <textarea class="form-control" name="address" id="editVendorAddress" rows="2"></textarea>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Category</label>
                            <select class="form-control" name="category" id="editVendorCategory" required>
                                <option value="">Select Category</option>
                                <option value="Technology">Technology</option>
                                <option value="Consulting">Consulting</option>
                                <option value="Professional Services">Professional Services</option>
                                <option value="Manufacturing">Manufacturing</option>
                                <option value="Logistics">Logistics</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label>Rating</label>
                            <select class="form-control" name="rating" id="editVendorRating">
                                <option value="5">5 - Excellent</option>
                                <option value="4">4 - Good</option>
                                <option value="3">3 - Average</option>
                                <option value="2">2 - Below Average</option>
                                <option value="1">1 - Poor</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Status</label>
                            <select class="form-control" name="status" id="editVendorStatus" required>
                                <option value="Pending">Pending Approval</option>
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                                <option value="Rejected">Rejected</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('editVendorModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="updateVendor()">Update Vendor</button>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New User</h3>
                <span class="close" onclick="closeModal('addUserModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addUserForm">
                    <div class="form-row">
                        <div class="form-col">
                            <label>Full Name</label>
                            <input type="text" class="form-control" name="name" required>
                        </div>
                        <div class="form-col">
                            <label>Email</label>
                            <input type="email" class="form-control" name="email" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Role</label>
                            <select class="form-control" name="role" required>
                                <option value="">Select Role</option>
                                <option value="Administrator">Administrator</option>
                                <option value="Manager">Manager</option>
                                <option value="Procurement">Procurement</option>
                                <option value="Finance">Finance</option>
                                <option value="IT">IT</option>
                                <option value="Analyst">Analyst</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label>Department</label>
                            <select class="form-control" name="department" required>
                                <option value="">Select Department</option>
                                <option value="Administration">Administration</option>
                                <option value="Procurement">Procurement</option>
                                <option value="Finance">Finance</option>
                                <option value="IT">Information Technology</option>
                                <option value="Legal">Legal</option>
                                <option value="Operations">Operations</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Phone</label>
                            <input type="tel" class="form-control" name="phone">
                        </div>
                        <div class="form-col">
                            <label>Employee ID</label>
                            <input type="text" class="form-control" name="employeeId">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Temporary Password</label>
                            <input type="password" class="form-control" name="password" required>
                            <small style="color: #7f8c8d;">User will be required to change password on first login</small>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addUserModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveUser()">Save User</button>
            </div>
        </div>
    </div>

    <!-- Add Workflow Modal -->
    <div id="addWorkflowModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create New Workflow</h3>
                <span class="close" onclick="closeModal('addWorkflowModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addWorkflowForm">
                    <div class="form-row">
                        <div class="form-col">
                            <label>Workflow Name</label>
                            <input type="text" class="form-control" name="name" required>
                        </div>
                        <div class="form-col">
                            <label>Type</label>
                            <select class="form-control" name="type" required>
                                <option value="">Select Type</option>
                                <option value="Contract Approval">Contract Approval</option>
                                <option value="Vendor Approval">Vendor Approval</option>
                                <option value="Document Review">Document Review</option>
                                <option value="Budget Approval">Budget Approval</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Assigned To</label>
                            <select class="form-control" name="assignedTo" required>
                                <option value="">Select User</option>
                                <option value="admin@ruyatrack.com">Administrator</option>
                                <option value="manager@ruyatrack.com">Manager</option>
                                <option value="procurement@ruyatrack.com">Procurement Team</option>
                                <option value="finance@ruyatrack.com">Finance Team</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label>Priority</label>
                            <select class="form-control" name="priority" required>
                                <option value="Low">Low</option>
                                <option value="Medium" selected>Medium</option>
                                <option value="High">High</option>
                                <option value="Critical">Critical</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Due Date</label>
                            <input type="date" class="form-control" name="dueDate" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label>Description</label>
                            <textarea class="form-control" name="description" rows="3"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('addWorkflowModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveWorkflow()">Create Workflow</button>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentUser = null;
        let currentUserRole = null;
        let contracts = [];
        let vendors = [];
        let workflows = [];
        let users = [];
        let currentVendorView = 'table';

        // User Roles and Permissions
        const userRoles = {
            'admin@ruyatrack.com': { role: 'Administrator', name: 'Administrator', department: 'Administration', permissions: ['all'] },
            'manager@ruyatrack.com': { role: 'Manager', name: 'Manager', department: 'Management', permissions: ['contracts', 'vendors', 'workflows', 'reports'] },
            'procurement@ruyatrack.com': { role: 'Procurement', name: 'Procurement Officer', department: 'Procurement', permissions: ['contracts', 'vendors', 'workflows'] },
            'finance@ruyatrack.com': { role: 'Finance', name: 'Finance Manager', department: 'Finance', permissions: ['contracts', 'reports', 'analytics'] },
            'it@ruyatrack.com': { role: 'IT', name: 'IT Administrator', department: 'IT', permissions: ['users', 'settings', 'reports'] },
            'analyst@ruyatrack.com': { role: 'Analyst', name: 'Business Analyst', department: 'Analytics', permissions: ['reports', 'analytics'] }
        };

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            // Check for existing session
            const savedSession = localStorage.getItem('clm_session');
            if (savedSession) {
                try {
                    const sessionData = JSON.parse(savedSession);
                    if (userRoles[sessionData.email]) {
                        currentUser = sessionData;
                        currentUserRole = userRoles[sessionData.email];
                        showApp();
                        return;
                    }
                } catch (e) {
                    localStorage.removeItem('clm_session');
                }
            }

            // Show login page
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('appContainer').style.display = 'none';

            // Setup login form
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
        });

        // Authentication Functions
        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Check if user exists in our system
            if (userRoles[email]) {
                // For demo purposes, accept any password
                currentUser = { email: email };
                currentUserRole = userRoles[email];
                
                // Save session
                localStorage.setItem('clm_session', JSON.stringify(currentUser));
                
                showApp();
                showNotification('Welcome to RuyaTracker CLM Enterprise!', 'success');
            } else {
                showNotification('Invalid credentials. Please use demo accounts.', 'error');
            }
        }

        function showApp() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            
            // Update user info in header
            document.getElementById('userName').textContent = currentUserRole.name;
            document.getElementById('userAvatar').textContent = currentUserRole.name.charAt(0);
            
            // Initialize data
            initializeData();
            
            // Load dashboard
            showSection('dashboard');
        }

        function logout() {
            localStorage.removeItem('clm_session');
            currentUser = null;
            currentUserRole = null;
            
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('appContainer').style.display = 'none';
            
            // Reset form
            document.getElementById('loginForm').reset();
        }

        // Navigation Functions
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Update navigation
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            
            // Find and activate the correct nav item
            navItems.forEach(item => {
                if (item.textContent.toLowerCase().includes(sectionId)) {
                    item.classList.add('active');
                }
            });
            
            // Load section-specific data
            switch(sectionId) {
                case 'dashboard':
                    loadDashboardData();
                    renderCharts();
                    break;
                case 'contracts':
                    loadContractsData();
                    break;
                case 'vendors':
                    loadVendorsData();
                    break;
                case 'workflows':
                    loadWorkflowsData();
                    break;
                case 'analytics':
                    renderAnalyticsCharts();
                    break;
                case 'users':
                    loadUsersData();
                    break;
            }
        }

        // Data Initialization
        function initializeData() {
            // Initialize sample contracts
            contracts = [
                {
                    id: 1,
                    contractId: 'CNT-2024-001',
                    title: 'Microsoft Office 365 Enterprise License',
                    vendor: 'Microsoft Corporation',
                    value: 180000,
                    status: 'Active',
                    startDate: '2024-01-01',
                    endDate: '2024-12-31',
                    category: 'Software License',
                    priority: 'High',
                    description: 'Enterprise-wide Office 365 licensing for 500 users',
                    document: 'microsoft_office365_contract.pdf'
                },
                {
                    id: 2,
                    contractId: 'CNT-2024-002',
                    title: 'Oracle Database Maintenance',
                    vendor: 'Oracle Systems',
                    value: 95000,
                    status: 'P1',
                    startDate: '2024-02-01',
                    endDate: '2025-01-31',
                    category: 'Maintenance',
                    priority: 'Medium',
                    description: 'Annual maintenance and support for Oracle Database systems',
                    document: 'oracle_maintenance_contract.pdf'
                },
                {
                    id: 3,
                    contractId: 'CNT-2024-003',
                    title: 'SAP Implementation Services',
                    vendor: 'SAP Solutions',
                    value: 450000,
                    status: 'P2',
                    startDate: '2024-03-01',
                    endDate: '2024-09-30',
                    category: 'Professional Services',
                    priority: 'Critical',
                    description: 'SAP ERP implementation and customization services',
                    document: 'sap_implementation_contract.pdf'
                }
            ];

            // Initialize sample vendors
            vendors = [
                {
                    id: 1,
                    vendorId: 'VND-001',
                    name: 'Microsoft Corporation',
                    contact: 'John Smith',
                    email: 'john.smith@microsoft.com',
                    phone: '+1-425-882-8080',
                    address: 'One Microsoft Way, Redmond, WA 98052, USA',
                    category: 'Technology',
                    rating: 5,
                    status: 'Active',
                    documents: ['microsoft_profile.pdf', 'microsoft_certifications.pdf']
                },
                {
                    id: 2,
                    vendorId: 'VND-002',
                    name: 'Oracle Systems',
                    contact: 'Sarah Johnson',
                    email: 'sarah.johnson@oracle.com',
                    phone: '+1-650-506-7000',
                    address: '500 Oracle Parkway, Redwood City, CA 94065, USA',
                    category: 'Technology',
                    rating: 4,
                    status: 'Active',
                    documents: ['oracle_profile.pdf']
                },
                {
                    id: 3,
                    vendorId: 'VND-003',
                    name: 'SAP Solutions',
                    contact: 'Michael Brown',
                    email: 'michael.brown@sap.com',
                    phone: '+49-6227-7-47474',
                    address: 'Dietmar-Hopp-Allee 16, 69190 Walldorf, Germany',
                    category: 'Technology',
                    rating: 5,
                    status: 'Pending',
                    documents: ['sap_profile.pdf', 'sap_certifications.pdf']
                },
                {
                    id: 4,
                    vendorId: 'VND-004',
                    name: 'Accenture',
                    contact: 'Emily Davis',
                    email: 'emily.davis@accenture.com',
                    phone: '+1-312-693-0161',
                    address: '161 N Clark St, Chicago, IL 60601, USA',
                    category: 'Consulting',
                    rating: 4,
                    status: 'Active',
                    documents: ['accenture_profile.pdf']
                }
            ];

            // Initialize sample workflows
            workflows = [
                {
                    id: 1,
                    workflowId: 'WF-2024-001',
                    name: 'Oracle Contract Approval',
                    type: 'Contract Approval',
                    status: 'In Progress',
                    assignedTo: 'procurement@ruyatrack.com',
                    createdDate: '2024-01-15',
                    dueDate: '2024-01-25',
                    priority: 'Medium',
                    description: 'Approval workflow for Oracle Database Maintenance contract'
                },
                {
                    id: 2,
                    workflowId: 'WF-2024-002',
                    name: 'SAP Vendor Approval',
                    type: 'Vendor Approval',
                    status: 'Pending',
                    assignedTo: 'manager@ruyatrack.com',
                    createdDate: '2024-01-20',
                    dueDate: '2024-01-30',
                    priority: 'High',
                    description: 'New vendor approval for SAP Solutions'
                }
            ];

            // Initialize sample users
            users = [
                {
                    id: 1,
                    userId: 'USR-001',
                    name: 'Administrator',
                    email: 'admin@ruyatrack.com',
                    role: 'Administrator',
                    department: 'Administration',
                    status: 'Active',
                    lastLogin: '2024-01-22 09:30:00',
                    phone: '+966-11-123-4567',
                    employeeId: 'EMP-001'
                },
                {
                    id: 2,
                    userId: 'USR-002',
                    name: 'Manager',
                    email: 'manager@ruyatrack.com',
                    role: 'Manager',
                    department: 'Management',
                    status: 'Active',
                    lastLogin: '2024-01-22 08:45:00',
                    phone: '+966-11-123-4568',
                    employeeId: 'EMP-002'
                },
                {
                    id: 3,
                    userId: 'USR-003',
                    name: 'Procurement Officer',
                    email: 'procurement@ruyatrack.com',
                    role: 'Procurement',
                    department: 'Procurement',
                    status: 'Active',
                    lastLogin: '2024-01-21 16:20:00',
                    phone: '+966-11-123-4569',
                    employeeId: 'EMP-003'
                },
                {
                    id: 4,
                    userId: 'USR-004',
                    name: 'Finance Manager',
                    email: 'finance@ruyatrack.com',
                    role: 'Finance',
                    department: 'Finance',
                    status: 'Active',
                    lastLogin: '2024-01-22 07:15:00',
                    phone: '+966-11-123-4570',
                    employeeId: 'EMP-004'
                }
            ];

            // Save data to localStorage for persistence
            saveDataToStorage();
        }

        // Data Persistence Functions
        function saveDataToStorage() {
            localStorage.setItem('clm_contracts', JSON.stringify(contracts));
            localStorage.setItem('clm_vendors', JSON.stringify(vendors));
            localStorage.setItem('clm_workflows', JSON.stringify(workflows));
            localStorage.setItem('clm_users', JSON.stringify(users));
        }

        function loadDataFromStorage() {
            const savedContracts = localStorage.getItem('clm_contracts');
            const savedVendors = localStorage.getItem('clm_vendors');
            const savedWorkflows = localStorage.getItem('clm_workflows');
            const savedUsers = localStorage.getItem('clm_users');

            if (savedContracts) contracts = JSON.parse(savedContracts);
            if (savedVendors) vendors = JSON.parse(savedVendors);
            if (savedWorkflows) workflows = JSON.parse(savedWorkflows);
            if (savedUsers) users = JSON.parse(savedUsers);
        }

        // Dashboard Functions
        function loadDashboardData() {
            // Load data from storage
            loadDataFromStorage();

            // Update KPI cards
            document.getElementById('totalContracts').textContent = contracts.length;
            document.getElementById('activeVendors').textContent = vendors.filter(v => v.status === 'Active').length;
            document.getElementById('pendingApprovals').textContent = workflows.filter(w => w.status === 'Pending' || w.status === 'In Progress').length;
            
            const totalValue = contracts.reduce((sum, contract) => sum + contract.value, 0);
            document.getElementById('totalValue').textContent = formatCurrency(totalValue);

            // Load pending approvals
            loadPendingApprovals();

            // Load recent activity
            loadRecentActivity();
        }

        function loadPendingApprovals() {
            const pendingList = document.getElementById('pendingApprovalsList');
            const userRole = currentUserRole.role;
            
            let pendingItems = [];

            // Add contract approvals based on user role
            contracts.forEach(contract => {
                if ((contract.status === 'P1' && userRole === 'Procurement') ||
                    (contract.status === 'P2' && userRole === 'Manager') ||
                    (contract.status === 'PF' && userRole === 'Administrator')) {
                    pendingItems.push({
                        type: 'contract',
                        id: contract.id,
                        title: `Contract: ${contract.title}`,
                        description: `${contract.vendor} - ${formatCurrency(contract.value)}`,
                        status: contract.status
                    });
                }
            });

            // Add vendor approvals
            vendors.forEach(vendor => {
                if (vendor.status === 'Pending' && (userRole === 'Procurement' || userRole === 'Manager')) {
                    pendingItems.push({
                        type: 'vendor',
                        id: vendor.id,
                        title: `Vendor: ${vendor.name}`,
                        description: `${vendor.category} - ${vendor.contact}`,
                        status: 'Pending'
                    });
                }
            });

            // Add workflow approvals
            workflows.forEach(workflow => {
                if ((workflow.status === 'Pending' || workflow.status === 'In Progress') && 
                    workflow.assignedTo === currentUser.email) {
                    pendingItems.push({
                        type: 'workflow',
                        id: workflow.id,
                        title: `Workflow: ${workflow.name}`,
                        description: `${workflow.type} - Due: ${workflow.dueDate}`,
                        status: workflow.status
                    });
                }
            });

            if (pendingItems.length === 0) {
                pendingList.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">No pending approvals</p>';
                return;
            }

            pendingList.innerHTML = pendingItems.map(item => `
                <div class="approval-item">
                    <div class="approval-info">
                        <h4>${item.title}</h4>
                        <p>${item.description}</p>
                    </div>
                    <div class="approval-actions">
                        <button class="btn btn-success btn-sm" onclick="approveItem('${item.type}', ${item.id})">Approve</button>
                        <button class="btn btn-danger btn-sm" onclick="rejectItem('${item.type}', ${item.id})">Reject</button>
                        <button class="btn btn-secondary btn-sm" onclick="viewItem('${item.type}', ${item.id})">View</button>
                    </div>
                </div>
            `).join('');
        }

        function loadRecentActivity() {
            const activityFeed = document.getElementById('activityFeed');
            
            const activities = [
                {
                    type: 'contract',
                    icon: '📄',
                    title: 'New contract created',
                    description: 'Microsoft Office 365 Enterprise License',
                    time: '2 hours ago'
                },
                {
                    type: 'vendor',
                    icon: '🏢',
                    title: 'Vendor approved',
                    description: 'Oracle Systems vendor profile approved',
                    time: '4 hours ago'
                },
                {
                    type: 'workflow',
                    icon: '⚡',
                    title: 'Workflow completed',
                    description: 'SAP Implementation approval workflow',
                    time: '1 day ago'
                },
                {
                    type: 'contract',
                    icon: '📄',
                    title: 'Contract updated',
                    description: 'Oracle Database Maintenance contract modified',
                    time: '2 days ago'
                }
            ];

            activityFeed.innerHTML = activities.map(activity => `
                <div class="activity-item">
                    <div class="activity-icon ${activity.type}">
                        ${activity.icon}
                    </div>
                    <div class="activity-content">
                        <h4>${activity.title}</h4>
                        <p>${activity.description}</p>
                    </div>
                    <div class="activity-time">${activity.time}</div>
                </div>
            `).join('');
        }

        // Contract Functions
        function loadContractsData() {
            loadDataFromStorage();
            const tbody = document.getElementById('contractsTableBody');
            
            tbody.innerHTML = contracts.map(contract => `
                <tr>
                    <td>${contract.contractId}</td>
                    <td>${contract.title}</td>
                    <td>${contract.vendor}</td>
                    <td>${formatCurrency(contract.value)}</td>
                    <td><span class="status-badge status-${contract.status.toLowerCase()}">${contract.status}</span></td>
                    <td>${formatDate(contract.startDate)}</td>
                    <td>${formatDate(contract.endDate)}</td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="viewContract(${contract.id})">View</button>
                        <button class="btn btn-warning btn-sm" onclick="editContract(${contract.id})">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteContract(${contract.id})">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        function openAddContractModal() {
            document.getElementById('addContractModal').style.display = 'block';
        }

        function saveContract() {
            const form = document.getElementById('addContractForm');
            const formData = new FormData(form);
            
            const newContract = {
                id: contracts.length + 1,
                contractId: formData.get('contractId'),
                title: formData.get('title'),
                vendor: formData.get('vendor'),
                value: parseInt(formData.get('value')),
                status: 'Draft',
                startDate: formData.get('startDate'),
                endDate: formData.get('endDate'),
                category: formData.get('category'),
                priority: formData.get('priority'),
                description: formData.get('description'),
                document: formData.get('document') ? formData.get('document').name : null
            };

            contracts.push(newContract);
            saveDataToStorage();
            
            closeModal('addContractModal');
            loadContractsData();
            showNotification('Contract created successfully!', 'success');
            
            // Create approval workflow
            createContractApprovalWorkflow(newContract);
        }

        function viewContract(id) {
            const contract = contracts.find(c => c.id === id);
            if (!contract) return;

            const detailsHtml = `
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Contract ID:</strong></label>
                        <p>${contract.contractId}</p>
                    </div>
                    <div class="form-col">
                        <label><strong>Title:</strong></label>
                        <p>${contract.title}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Vendor:</strong></label>
                        <p>${contract.vendor}</p>
                    </div>
                    <div class="form-col">
                        <label><strong>Value:</strong></label>
                        <p>${formatCurrency(contract.value)}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Status:</strong></label>
                        <p><span class="status-badge status-${contract.status.toLowerCase()}">${contract.status}</span></p>
                    </div>
                    <div class="form-col">
                        <label><strong>Priority:</strong></label>
                        <p>${contract.priority}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Start Date:</strong></label>
                        <p>${formatDate(contract.startDate)}</p>
                    </div>
                    <div class="form-col">
                        <label><strong>End Date:</strong></label>
                        <p>${formatDate(contract.endDate)}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Category:</strong></label>
                        <p>${contract.category}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Description:</strong></label>
                        <p>${contract.description || 'No description provided'}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Document:</strong></label>
                        <p>${contract.document ? `<a href="#" onclick="viewDocument('${contract.document}')">${contract.document}</a>` : 'No document attached'}</p>
                    </div>
                </div>
            `;

            document.getElementById('contractDetails').innerHTML = detailsHtml;
            document.getElementById('viewContractModal').style.display = 'block';
        }

        function editContract(id) {
            const contract = contracts.find(c => c.id === id);
            if (!contract) return;

            // Populate edit form
            document.getElementById('editContractId').value = contract.id;
            document.getElementById('editContractTitle').value = contract.title;
            document.getElementById('editContractContractId').value = contract.contractId;
            document.getElementById('editContractVendor').value = contract.vendor;
            document.getElementById('editContractValue').value = contract.value;
            document.getElementById('editContractStartDate').value = contract.startDate;
            document.getElementById('editContractEndDate').value = contract.endDate;
            document.getElementById('editContractStatus').value = contract.status;
            document.getElementById('editContractPriority').value = contract.priority;
            document.getElementById('editContractDescription').value = contract.description || '';

            document.getElementById('editContractModal').style.display = 'block';
        }

        function updateContract() {
            const form = document.getElementById('editContractForm');
            const formData = new FormData(form);
            const id = parseInt(formData.get('id'));
            
            const contractIndex = contracts.findIndex(c => c.id === id);
            if (contractIndex === -1) return;

            contracts[contractIndex] = {
                ...contracts[contractIndex],
                title: formData.get('title'),
                contractId: formData.get('contractId'),
                vendor: formData.get('vendor'),
                value: parseInt(formData.get('value')),
                startDate: formData.get('startDate'),
                endDate: formData.get('endDate'),
                status: formData.get('status'),
                priority: formData.get('priority'),
                description: formData.get('description')
            };

            saveDataToStorage();
            closeModal('editContractModal');
            loadContractsData();
            showNotification('Contract updated successfully!', 'success');
        }

        function deleteContract(id) {
            if (confirm('Are you sure you want to delete this contract?')) {
                contracts = contracts.filter(c => c.id !== id);
                saveDataToStorage();
                loadContractsData();
                showNotification('Contract deleted successfully!', 'success');
            }
        }

        function editContractFromView() {
            closeModal('viewContractModal');
            const contractId = parseInt(document.getElementById('contractDetails').dataset.contractId);
            editContract(contractId);
        }

        // Vendor Functions
        function loadVendorsData() {
            loadDataFromStorage();
            
            if (currentVendorView === 'table') {
                loadVendorTableView();
            } else if (currentVendorView === 'list') {
                loadVendorListView();
            } else if (currentVendorView === 'cards') {
                loadVendorCardView();
            }
        }

        function switchVendorView(viewType) {
            currentVendorView = viewType;
            
            // Update view buttons
            document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Hide all views
            document.querySelectorAll('.vendor-view').forEach(view => view.classList.remove('active'));
            
            // Show selected view
            if (viewType === 'table') {
                document.getElementById('vendorTableView').classList.add('active');
                loadVendorTableView();
            } else if (viewType === 'list') {
                document.getElementById('vendorListView').classList.add('active');
                loadVendorListView();
            } else if (viewType === 'cards') {
                document.getElementById('vendorCardView').classList.add('active');
                loadVendorCardView();
            }
        }

        function loadVendorTableView() {
            const tbody = document.getElementById('vendorsTableBody');
            
            tbody.innerHTML = vendors.map(vendor => `
                <tr>
                    <td>${vendor.vendorId}</td>
                    <td>${vendor.name}</td>
                    <td>${vendor.contact}</td>
                    <td>${vendor.email}</td>
                    <td>${vendor.category}</td>
                    <td>${'⭐'.repeat(vendor.rating)}</td>
                    <td>
                        <span class="status-badge status-${vendor.status.toLowerCase()}">${vendor.status}</span>
                        ${vendor.status === 'Pending' ? '<span class="approval-indicator procurement" data-tooltip="Pending Procurement Approval">📋 P</span>' : ''}
                    </td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="viewVendor(${vendor.id})">View</button>
                        <button class="btn btn-warning btn-sm" onclick="editVendor(${vendor.id})">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteVendor(${vendor.id})">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        function loadVendorListView() {
            const container = document.getElementById('vendorsList');
            
            container.innerHTML = vendors.map(vendor => `
                <div class="list-item">
                    <div>
                        <h4>${vendor.name}</h4>
                        <p>${vendor.contact} - ${vendor.email} - ${vendor.category}</p>
                        <p>Rating: ${'⭐'.repeat(vendor.rating)} | Status: <span class="status-badge status-${vendor.status.toLowerCase()}">${vendor.status}</span></p>
                    </div>
                    <div>
                        <button class="btn btn-secondary btn-sm" onclick="viewVendor(${vendor.id})">View</button>
                        <button class="btn btn-warning btn-sm" onclick="editVendor(${vendor.id})">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteVendor(${vendor.id})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function loadVendorCardView() {
            const container = document.getElementById('vendorsCards');
            
            container.innerHTML = vendors.map(vendor => `
                <div class="card-item">
                    <h4>${vendor.name}</h4>
                    <p><strong>Contact:</strong> ${vendor.contact}</p>
                    <p><strong>Email:</strong> ${vendor.email}</p>
                    <p><strong>Category:</strong> ${vendor.category}</p>
                    <p><strong>Rating:</strong> ${'⭐'.repeat(vendor.rating)}</p>
                    <p><strong>Status:</strong> <span class="status-badge status-${vendor.status.toLowerCase()}">${vendor.status}</span></p>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-secondary btn-sm" onclick="viewVendor(${vendor.id})">View</button>
                        <button class="btn btn-warning btn-sm" onclick="editVendor(${vendor.id})">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteVendor(${vendor.id})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function openAddVendorModal() {
            document.getElementById('addVendorModal').style.display = 'block';
        }

        function saveVendor() {
            const form = document.getElementById('addVendorForm');
            const formData = new FormData(form);
            
            const newVendor = {
                id: vendors.length + 1,
                vendorId: `VND-${String(vendors.length + 1).padStart(3, '0')}`,
                name: formData.get('name'),
                contact: formData.get('contact'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                address: formData.get('address'),
                category: formData.get('category'),
                rating: parseInt(formData.get('rating')),
                status: 'Pending',
                documents: formData.get('documents') ? [formData.get('documents').name] : []
            };

            vendors.push(newVendor);
            saveDataToStorage();
            
            closeModal('addVendorModal');
            loadVendorsData();
            showNotification('Vendor created successfully! Pending approval.', 'success');
            
            // Create vendor approval workflow
            createVendorApprovalWorkflow(newVendor);
        }

        function viewVendor(id) {
            const vendor = vendors.find(v => v.id === id);
            if (!vendor) return;

            const detailsHtml = `
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Vendor ID:</strong></label>
                        <p>${vendor.vendorId}</p>
                    </div>
                    <div class="form-col">
                        <label><strong>Name:</strong></label>
                        <p>${vendor.name}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Contact Person:</strong></label>
                        <p>${vendor.contact}</p>
                    </div>
                    <div class="form-col">
                        <label><strong>Email:</strong></label>
                        <p>${vendor.email}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Phone:</strong></label>
                        <p>${vendor.phone}</p>
                    </div>
                    <div class="form-col">
                        <label><strong>Category:</strong></label>
                        <p>${vendor.category}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Rating:</strong></label>
                        <p>${'⭐'.repeat(vendor.rating)} (${vendor.rating}/5)</p>
                    </div>
                    <div class="form-col">
                        <label><strong>Status:</strong></label>
                        <p><span class="status-badge status-${vendor.status.toLowerCase()}">${vendor.status}</span></p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Address:</strong></label>
                        <p>${vendor.address || 'No address provided'}</p>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label><strong>Documents:</strong></label>
                        <p>${vendor.documents && vendor.documents.length > 0 ? 
                            vendor.documents.map(doc => `<a href="#" onclick="viewDocument('${doc}')">${doc}</a>`).join(', ') : 
                            'No documents uploaded'}</p>
                    </div>
                </div>
            `;

            document.getElementById('vendorDetails').innerHTML = detailsHtml;
            document.getElementById('vendorDetails').dataset.vendorId = id;
            document.getElementById('viewVendorModal').style.display = 'block';
        }

        function editVendor(id) {
            const vendor = vendors.find(v => v.id === id);
            if (!vendor) return;

            // Populate edit form
            document.getElementById('editVendorId').value = vendor.id;
            document.getElementById('editVendorName').value = vendor.name;
            document.getElementById('editVendorContact').value = vendor.contact;
            document.getElementById('editVendorEmail').value = vendor.email;
            document.getElementById('editVendorPhone').value = vendor.phone;
            document.getElementById('editVendorAddress').value = vendor.address || '';
            document.getElementById('editVendorCategory').value = vendor.category;
            document.getElementById('editVendorRating').value = vendor.rating;
            document.getElementById('editVendorStatus').value = vendor.status;

            document.getElementById('editVendorModal').style.display = 'block';
        }

        function updateVendor() {
            const form = document.getElementById('editVendorForm');
            const formData = new FormData(form);
            const id = parseInt(formData.get('id'));
            
            const vendorIndex = vendors.findIndex(v => v.id === id);
            if (vendorIndex === -1) return;

            vendors[vendorIndex] = {
                ...vendors[vendorIndex],
                name: formData.get('name'),
                contact: formData.get('contact'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                address: formData.get('address'),
                category: formData.get('category'),
                rating: parseInt(formData.get('rating')),
                status: formData.get('status')
            };

            saveDataToStorage();
            closeModal('editVendorModal');
            loadVendorsData();
            showNotification('Vendor updated successfully!', 'success');
        }

        function deleteVendor(id) {
            if (confirm('Are you sure you want to delete this vendor?')) {
                vendors = vendors.filter(v => v.id !== id);
                saveDataToStorage();
                loadVendorsData();
                showNotification('Vendor deleted successfully!', 'success');
            }
        }

        function editVendorFromView() {
            closeModal('viewVendorModal');
            const vendorId = parseInt(document.getElementById('vendorDetails').dataset.vendorId);
            editVendor(vendorId);
        }

        // Workflow Functions
        function loadWorkflowsData() {
            loadDataFromStorage();
            const tbody = document.getElementById('workflowsTableBody');
            
            tbody.innerHTML = workflows.map(workflow => `
                <tr>
                    <td>${workflow.workflowId}</td>
                    <td>${workflow.name}</td>
                    <td>${workflow.type}</td>
                    <td><span class="status-badge status-${workflow.status.toLowerCase().replace(' ', '-')}">${workflow.status}</span></td>
                    <td>${workflow.assignedTo}</td>
                    <td>${formatDate(workflow.createdDate)}</td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="viewWorkflow(${workflow.id})">View</button>
                        <button class="btn btn-warning btn-sm" onclick="editWorkflow(${workflow.id})">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteWorkflow(${workflow.id})">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        function openAddWorkflowModal() {
            document.getElementById('addWorkflowModal').style.display = 'block';
        }

        function saveWorkflow() {
            const form = document.getElementById('addWorkflowForm');
            const formData = new FormData(form);
            
            const newWorkflow = {
                id: workflows.length + 1,
                workflowId: `WF-2024-${String(workflows.length + 1).padStart(3, '0')}`,
                name: formData.get('name'),
                type: formData.get('type'),
                status: 'Pending',
                assignedTo: formData.get('assignedTo'),
                createdDate: new Date().toISOString().split('T')[0],
                dueDate: formData.get('dueDate'),
                priority: formData.get('priority'),
                description: formData.get('description')
            };

            workflows.push(newWorkflow);
            saveDataToStorage();
            
            closeModal('addWorkflowModal');
            loadWorkflowsData();
            showNotification('Workflow created successfully!', 'success');
        }

        function viewWorkflow(id) {
            showNotification(`Viewing workflow ${id}`, 'info');
        }

        function editWorkflow(id) {
            showNotification(`Editing workflow ${id}`, 'info');
        }

        function deleteWorkflow(id) {
            if (confirm('Are you sure you want to delete this workflow?')) {
                workflows = workflows.filter(w => w.id !== id);
                saveDataToStorage();
                loadWorkflowsData();
                showNotification('Workflow deleted successfully!', 'success');
            }
        }

        // User Functions
        function loadUsersData() {
            loadDataFromStorage();
            const tbody = document.getElementById('usersTableBody');
            
            tbody.innerHTML = users.map(user => `
                <tr>
                    <td>${user.userId}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.role}</td>
                    <td>${user.department}</td>
                    <td><span class="status-badge status-${user.status.toLowerCase()}">${user.status}</span></td>
                    <td>${user.lastLogin}</td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="viewUser(${user.id})">View</button>
                        <button class="btn btn-warning btn-sm" onclick="editUser(${user.id})">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deactivateUser(${user.id})">Deactivate</button>
                    </td>
                </tr>
            `).join('');
        }

        function openAddUserModal() {
            document.getElementById('addUserModal').style.display = 'block';
        }

        function saveUser() {
            const form = document.getElementById('addUserForm');
            const formData = new FormData(form);
            
            const newUser = {
                id: users.length + 1,
                userId: `USR-${String(users.length + 1).padStart(3, '0')}`,
                name: formData.get('name'),
                email: formData.get('email'),
                role: formData.get('role'),
                department: formData.get('department'),
                status: 'Active',
                lastLogin: 'Never',
                phone: formData.get('phone'),
                employeeId: formData.get('employeeId')
            };

            users.push(newUser);
            saveDataToStorage();
            
            closeModal('addUserModal');
            loadUsersData();
            showNotification('User created successfully!', 'success');
        }

        function viewUser(id) {
            showNotification(`Viewing user ${id}`, 'info');
        }

        function editUser(id) {
            showNotification(`Editing user ${id}`, 'info');
        }

        function deactivateUser(id) {
            if (confirm('Are you sure you want to deactivate this user?')) {
                const userIndex = users.findIndex(u => u.id === id);
                if (userIndex !== -1) {
                    users[userIndex].status = 'Inactive';
                    saveDataToStorage();
                    loadUsersData();
                    showNotification('User deactivated successfully!', 'success');
                }
            }
        }

        // Settings Functions
        function showSettingsTab(tabName) {
            // Hide all settings sections
            document.querySelectorAll('.settings-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(tabName + 'Settings').classList.add('active');
            
            // Update tab buttons
            document.querySelectorAll('.settings-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function toggleSetting(element) {
            element.classList.toggle('active');
            showNotification('Setting updated successfully!', 'success');
        }

        function exportAuditLogs() {
            showNotification('Audit logs exported successfully!', 'success');
        }

        function testIntegration() {
            showNotification('Integration test completed successfully!', 'success');
        }

        function createBackup() {
            showNotification('Backup created successfully!', 'success');
        }

        // Approval Functions
        function approveItem(type, id) {
            if (type === 'contract') {
                const contract = contracts.find(c => c.id === id);
                if (contract) {
                    if (contract.status === 'P1') {
                        contract.status = 'P2';
                    } else if (contract.status === 'P2') {
                        contract.status = 'PF';
                    } else if (contract.status === 'PF') {
                        contract.status = 'Approved';
                    }
                    saveDataToStorage();
                    showNotification('Contract approved successfully!', 'success');
                }
            } else if (type === 'vendor') {
                const vendor = vendors.find(v => v.id === id);
                if (vendor) {
                    vendor.status = 'Active';
                    saveDataToStorage();
                    showNotification('Vendor approved successfully!', 'success');
                }
            } else if (type === 'workflow') {
                const workflow = workflows.find(w => w.id === id);
                if (workflow) {
                    workflow.status = 'Completed';
                    saveDataToStorage();
                    showNotification('Workflow approved successfully!', 'success');
                }
            }
            
            loadDashboardData();
        }

        function rejectItem(type, id) {
            if (type === 'contract') {
                const contract = contracts.find(c => c.id === id);
                if (contract) {
                    contract.status = 'Rejected';
                    saveDataToStorage();
                    showNotification('Contract rejected!', 'warning');
                }
            } else if (type === 'vendor') {
                const vendor = vendors.find(v => v.id === id);
                if (vendor) {
                    vendor.status = 'Rejected';
                    saveDataToStorage();
                    showNotification('Vendor rejected!', 'warning');
                }
            } else if (type === 'workflow') {
                const workflow = workflows.find(w => w.id === id);
                if (workflow) {
                    workflow.status = 'Rejected';
                    saveDataToStorage();
                    showNotification('Workflow rejected!', 'warning');
                }
            }
            
            loadDashboardData();
        }

        function viewItem(type, id) {
            if (type === 'contract') {
                viewContract(id);
            } else if (type === 'vendor') {
                viewVendor(id);
            } else if (type === 'workflow') {
                viewWorkflow(id);
            }
        }

        // Workflow Creation Functions
        function createContractApprovalWorkflow(contract) {
            const newWorkflow = {
                id: workflows.length + 1,
                workflowId: `WF-2024-${String(workflows.length + 1).padStart(3, '0')}`,
                name: `${contract.title} Approval`,
                type: 'Contract Approval',
                status: 'Pending',
                assignedTo: 'procurement@ruyatrack.com',
                createdDate: new Date().toISOString().split('T')[0],
                dueDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                priority: contract.priority,
                description: `Approval workflow for contract: ${contract.title}`
            };

            workflows.push(newWorkflow);
            saveDataToStorage();
        }

        function createVendorApprovalWorkflow(vendor) {
            const newWorkflow = {
                id: workflows.length + 1,
                workflowId: `WF-2024-${String(workflows.length + 1).padStart(3, '0')}`,
                name: `${vendor.name} Vendor Approval`,
                type: 'Vendor Approval',
                status: 'Pending',
                assignedTo: 'procurement@ruyatrack.com',
                createdDate: new Date().toISOString().split('T')[0],
                dueDate: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                priority: 'Medium',
                description: `Vendor approval workflow for: ${vendor.name}`
            };

            workflows.push(newWorkflow);
            saveDataToStorage();
        }

        // Chart Functions
        function renderCharts() {
            renderContractValueChart();
            renderVendorPerformanceChart();
            renderContractStatusChart();
            renderMonthlyTrendsChart();
        }

        function renderAnalyticsCharts() {
            renderFinancialChart();
            renderWorkflowStatusChart();
            renderVendorCategoryChart();
            renderPerformanceChart();
        }

        function renderContractValueChart() {
            const svg = document.getElementById('contractValueChart');
            if (!svg) return;

            const data = contracts.reduce((acc, contract) => {
                acc[contract.vendor] = (acc[contract.vendor] || 0) + contract


.value;
                return acc;
            }, {});

            const total = Object.values(data).reduce((sum, value) => sum + value, 0);
            const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe'];
            
            let currentAngle = 0;
            const centerX = 150;
            const centerY = 150;
            const radius = 100;

            svg.innerHTML = '';

            Object.entries(data).forEach(([vendor, value], index) => {
                const percentage = (value / total) * 100;
                const angle = (value / total) * 2 * Math.PI;
                
                const x1 = centerX + radius * Math.cos(currentAngle);
                const y1 = centerY + radius * Math.sin(currentAngle);
                const x2 = centerX + radius * Math.cos(currentAngle + angle);
                const y2 = centerY + radius * Math.sin(currentAngle + angle);
                
                const largeArcFlag = angle > Math.PI ? 1 : 0;
                
                const pathData = [
                    `M ${centerX} ${centerY}`,
                    `L ${x1} ${y1}`,
                    `A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2}`,
                    'Z'
                ].join(' ');

                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', pathData);
                path.setAttribute('fill', colors[index % colors.length]);
                path.setAttribute('stroke', 'white');
                path.setAttribute('stroke-width', '2');
                
                // Add hover effect
                path.addEventListener('mouseenter', function() {
                    this.setAttribute('opacity', '0.8');
                    showTooltip(`${vendor}: ${formatCurrency(value)}`);
                });
                
                path.addEventListener('mouseleave', function() {
                    this.setAttribute('opacity', '1');
                    hideTooltip();
                });

                svg.appendChild(path);
                currentAngle += angle;
            });
        }

        function renderVendorPerformanceChart() {
            const svg = document.getElementById('vendorPerformanceChart');
            if (!svg) return;

            const data = vendors.map(vendor => ({
                name: vendor.name.split(' ')[0], // First word only
                rating: vendor.rating
            }));

            const maxRating = 5;
            const barWidth = 40;
            const barSpacing = 10;
            const chartHeight = 200;
            const chartWidth = 300;

            svg.innerHTML = '';

            data.forEach((vendor, index) => {
                const x = 50 + index * (barWidth + barSpacing);
                const barHeight = (vendor.rating / maxRating) * chartHeight;
                const y = chartHeight - barHeight + 30;

                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('x', x);
                rect.setAttribute('y', y);
                rect.setAttribute('width', barWidth);
                rect.setAttribute('height', barHeight);
                rect.setAttribute('fill', '#667eea');
                rect.setAttribute('stroke', 'white');
                rect.setAttribute('stroke-width', '1');

                // Add hover effect
                rect.addEventListener('mouseenter', function() {
                    this.setAttribute('fill', '#5a6fd8');
                    showTooltip(`${vendor.name}: ${vendor.rating} rating`);
                });
                
                rect.addEventListener('mouseleave', function() {
                    this.setAttribute('fill', '#667eea');
                    hideTooltip();
                });

                svg.appendChild(rect);

                // Add label
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', x + barWidth / 2);
                text.setAttribute('y', chartHeight + 50);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('font-size', '12');
                text.setAttribute('fill', '#333');
                text.textContent = vendor.name;
                svg.appendChild(text);
            });
        }

        function renderContractStatusChart() {
            const svg = document.getElementById('contractStatusChart');
            if (!svg) return;

            const statusCounts = contracts.reduce((acc, contract) => {
                acc[contract.status] = (acc[contract.status] || 0) + 1;
                return acc;
            }, {});

            const total = Object.values(statusCounts).reduce((sum, count) => sum + count, 0);
            const colors = {
                'Active': '#27ae60',
                'P1': '#f39c12',
                'P2': '#e67e22',
                'PF': '#9b59b6',
                'Approved': '#2ecc71',
                'Draft': '#95a5a6',
                'Rejected': '#e74c3c'
            };

            let currentAngle = 0;
            const centerX = 150;
            const centerY = 150;
            const outerRadius = 100;
            const innerRadius = 50;

            svg.innerHTML = '';

            Object.entries(statusCounts).forEach(([status, count]) => {
                const angle = (count / total) * 2 * Math.PI;
                
                const x1 = centerX + outerRadius * Math.cos(currentAngle);
                const y1 = centerY + outerRadius * Math.sin(currentAngle);
                const x2 = centerX + outerRadius * Math.cos(currentAngle + angle);
                const y2 = centerY + outerRadius * Math.sin(currentAngle + angle);
                
                const x3 = centerX + innerRadius * Math.cos(currentAngle + angle);
                const y3 = centerY + innerRadius * Math.sin(currentAngle + angle);
                const x4 = centerX + innerRadius * Math.cos(currentAngle);
                const y4 = centerY + innerRadius * Math.sin(currentAngle);
                
                const largeArcFlag = angle > Math.PI ? 1 : 0;
                
                const pathData = [
                    `M ${x1} ${y1}`,
                    `A ${outerRadius} ${outerRadius} 0 ${largeArcFlag} 1 ${x2} ${y2}`,
                    `L ${x3} ${y3}`,
                    `A ${innerRadius} ${innerRadius} 0 ${largeArcFlag} 0 ${x4} ${y4}`,
                    'Z'
                ].join(' ');

                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', pathData);
                path.setAttribute('fill', colors[status] || '#95a5a6');
                path.setAttribute('stroke', 'white');
                path.setAttribute('stroke-width', '2');
                
                // Add hover effect
                path.addEventListener('mouseenter', function() {
                    this.setAttribute('opacity', '0.8');
                    showTooltip(`${status}: ${count} contracts`);
                });
                
                path.addEventListener('mouseleave', function() {
                    this.setAttribute('opacity', '1');
                    hideTooltip();
                });

                svg.appendChild(path);
                currentAngle += angle;
            });
        }

        function renderMonthlyTrendsChart() {
            const svg = document.getElementById('monthlyTrendsChart');
            if (!svg) return;

            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            const data = [1, 2, 1, 3, 2, 3]; // Sample data
            
            const chartWidth = 300;
            const chartHeight = 200;
            const maxValue = Math.max(...data);

            svg.innerHTML = '';

            // Draw lines
            const points = data.map((value, index) => {
                const x = 50 + (index * (chartWidth - 100) / (data.length - 1));
                const y = chartHeight - (value / maxValue * (chartHeight - 50)) + 30;
                return `${x},${y}`;
            }).join(' ');

            const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
            polyline.setAttribute('points', points);
            polyline.setAttribute('fill', 'none');
            polyline.setAttribute('stroke', '#667eea');
            polyline.setAttribute('stroke-width', '3');
            svg.appendChild(polyline);

            // Draw points
            data.forEach((value, index) => {
                const x = 50 + (index * (chartWidth - 100) / (data.length - 1));
                const y = chartHeight - (value / maxValue * (chartHeight - 50)) + 30;

                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', x);
                circle.setAttribute('cy', y);
                circle.setAttribute('r', '5');
                circle.setAttribute('fill', '#667eea');
                circle.setAttribute('stroke', 'white');
                circle.setAttribute('stroke-width', '2');

                // Add hover effect
                circle.addEventListener('mouseenter', function() {
                    this.setAttribute('r', '7');
                    showTooltip(`${months[index]}: ${value} contracts`);
                });
                
                circle.addEventListener('mouseleave', function() {
                    this.setAttribute('r', '5');
                    hideTooltip();
                });

                svg.appendChild(circle);

                // Add month labels
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', x);
                text.setAttribute('y', chartHeight + 50);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('font-size', '12');
                text.setAttribute('fill', '#333');
                text.textContent = months[index];
                svg.appendChild(text);
            });
        }

        function renderFinancialChart() {
            const svg = document.getElementById('financialChart');
            if (!svg) return;

            const categories = ['Software', 'Services', 'Maintenance', 'Consulting'];
            const values = [180000, 450000, 95000, 120000];
            
            const maxValue = Math.max(...values);
            const barWidth = 50;
            const barSpacing = 20;
            const chartHeight = 200;

            svg.innerHTML = '';

            values.forEach((value, index) => {
                const x = 50 + index * (barWidth + barSpacing);
                const barHeight = (value / maxValue) * chartHeight;
                const y = chartHeight - barHeight + 30;

                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('x', x);
                rect.setAttribute('y', y);
                rect.setAttribute('width', barWidth);
                rect.setAttribute('height', barHeight);
                rect.setAttribute('fill', '#27ae60');

                // Add hover effect
                rect.addEventListener('mouseenter', function() {
                    this.setAttribute('fill', '#229954');
                    showTooltip(`${categories[index]}: ${formatCurrency(value)}`);
                });
                
                rect.addEventListener('mouseleave', function() {
                    this.setAttribute('fill', '#27ae60');
                    hideTooltip();
                });

                svg.appendChild(rect);

                // Add label
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', x + barWidth / 2);
                text.setAttribute('y', chartHeight + 50);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('font-size', '10');
                text.setAttribute('fill', '#333');
                text.textContent = categories[index];
                svg.appendChild(text);
            });
        }

        function renderWorkflowStatusChart() {
            const svg = document.getElementById('workflowStatusChart');
            if (!svg) return;

            const statusCounts = {
                'Pending': 2,
                'In Progress': 1,
                'Completed': 3,
                'Rejected': 1
            };

            const total = Object.values(statusCounts).reduce((sum, count) => sum + count, 0);
            const colors = {
                'Pending': '#f39c12',
                'In Progress': '#3498db',
                'Completed': '#27ae60',
                'Rejected': '#e74c3c'
            };

            let currentAngle = 0;
            const centerX = 150;
            const centerY = 150;
            const radius = 100;

            svg.innerHTML = '';

            Object.entries(statusCounts).forEach(([status, count]) => {
                const angle = (count / total) * 2 * Math.PI;
                
                const x1 = centerX + radius * Math.cos(currentAngle);
                const y1 = centerY + radius * Math.sin(currentAngle);
                const x2 = centerX + radius * Math.cos(currentAngle + angle);
                const y2 = centerY + radius * Math.sin(currentAngle + angle);
                
                const largeArcFlag = angle > Math.PI ? 1 : 0;
                
                const pathData = [
                    `M ${centerX} ${centerY}`,
                    `L ${x1} ${y1}`,
                    `A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2}`,
                    'Z'
                ].join(' ');

                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', pathData);
                path.setAttribute('fill', colors[status]);
                path.setAttribute('stroke', 'white');
                path.setAttribute('stroke-width', '2');
                
                // Add hover effect
                path.addEventListener('mouseenter', function() {
                    this.setAttribute('opacity', '0.8');
                    showTooltip(`${status}: ${count} workflows`);
                });
                
                path.addEventListener('mouseleave', function() {
                    this.setAttribute('opacity', '1');
                    hideTooltip();
                });

                svg.appendChild(path);
                currentAngle += angle;
            });
        }

        function renderVendorCategoryChart() {
            const svg = document.getElementById('vendorCategoryChart');
            if (!svg) return;

            const categoryCounts = vendors.reduce((acc, vendor) => {
                acc[vendor.category] = (acc[vendor.category] || 0) + 1;
                return acc;
            }, {});

            const total = Object.values(categoryCounts).reduce((sum, count) => sum + count, 0);
            const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe'];

            let currentAngle = 0;
            const centerX = 150;
            const centerY = 150;
            const radius = 100;

            svg.innerHTML = '';

            Object.entries(categoryCounts).forEach(([category, count], index) => {
                const angle = (count / total) * 2 * Math.PI;
                
                const x1 = centerX + radius * Math.cos(currentAngle);
                const y1 = centerY + radius * Math.sin(currentAngle);
                const x2 = centerX + radius * Math.cos(currentAngle + angle);
                const y2 = centerY + radius * Math.sin(currentAngle + angle);
                
                const largeArcFlag = angle > Math.PI ? 1 : 0;
                
                const pathData = [
                    `M ${centerX} ${centerY}`,
                    `L ${x1} ${y1}`,
                    `A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2}`,
                    'Z'
                ].join(' ');

                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', pathData);
                path.setAttribute('fill', colors[index % colors.length]);
                path.setAttribute('stroke', 'white');
                path.setAttribute('stroke-width', '2');
                
                // Add hover effect
                path.addEventListener('mouseenter', function() {
                    this.setAttribute('opacity', '0.8');
                    showTooltip(`${category}: ${count} vendors`);
                });
                
                path.addEventListener('mouseleave', function() {
                    this.setAttribute('opacity', '1');
                    hideTooltip();
                });

                svg.appendChild(path);
                currentAngle += angle;
            });
        }

        function renderPerformanceChart() {
            const svg = document.getElementById('performanceChart');
            if (!svg) return;

            const metrics = ['Contracts', 'Vendors', 'Workflows', 'Users'];
            const values = [contracts.length, vendors.length, workflows.length, users.length];
            
            const maxValue = Math.max(...values);
            const barWidth = 50;
            const barSpacing = 20;
            const chartHeight = 200;

            svg.innerHTML = '';

            values.forEach((value, index) => {
                const x = 50 + index * (barWidth + barSpacing);
                const barHeight = (value / maxValue) * chartHeight;
                const y = chartHeight - barHeight + 30;

                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('x', x);
                rect.setAttribute('y', y);
                rect.setAttribute('width', barWidth);
                rect.setAttribute('height', barHeight);
                rect.setAttribute('fill', '#9b59b6');

                // Add hover effect
                rect.addEventListener('mouseenter', function() {
                    this.setAttribute('fill', '#8e44ad');
                    showTooltip(`${metrics[index]}: ${value}`);
                });
                
                rect.addEventListener('mouseleave', function() {
                    this.setAttribute('fill', '#9b59b6');
                    hideTooltip();
                });

                svg.appendChild(rect);

                // Add label
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', x + barWidth / 2);
                text.setAttribute('y', chartHeight + 50);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('font-size', '10');
                text.setAttribute('fill', '#333');
                text.textContent = metrics[index];
                svg.appendChild(text);
            });
        }

        // Utility Functions
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'SAR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount).replace('SAR', '').trim() + ' SAR';
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-GB');
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `alert alert-${type}`;
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.minWidth = '300px';
            notification.style.maxWidth = '500px';

            document.body.appendChild(notification);

            // Remove after 3 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }

        function showTooltip(text) {
            let tooltip = document.getElementById('chartTooltip');
            if (!tooltip) {
                tooltip = document.createElement('div');
                tooltip.id = 'chartTooltip';
                tooltip.style.position = 'absolute';
                tooltip.style.background = '#333';
                tooltip.style.color = 'white';
                tooltip.style.padding = '8px 12px';
                tooltip.style.borderRadius = '4px';
                tooltip.style.fontSize = '12px';
                tooltip.style.pointerEvents = 'none';
                tooltip.style.zIndex = '1000';
                tooltip.style.opacity = '0';
                tooltip.style.transition = 'opacity 0.3s ease';
                document.body.appendChild(tooltip);
            }

            tooltip.textContent = text;
            tooltip.style.opacity = '1';

            // Position tooltip near mouse
            document.addEventListener('mousemove', function(e) {
                tooltip.style.left = (e.pageX + 10) + 'px';
                tooltip.style.top = (e.pageY - 30) + 'px';
            });
        }

        function hideTooltip() {
            const tooltip = document.getElementById('chartTooltip');
            if (tooltip) {
                tooltip.style.opacity = '0';
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            
            // Reset forms
            const modal = document.getElementById(modalId);
            const forms = modal.querySelectorAll('form');
            forms.forEach(form => form.reset());
        }

        function viewDocument(filename) {
            showNotification(`Opening document: ${filename}`, 'info');
        }

        function generateContractReport() {
            showNotification('Contract report generated successfully!', 'success');
        }

        function exportReport(format) {
            showNotification(`Report exported as ${format.toUpperCase()} successfully!`, 'success');
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Initialize tooltips
        document.addEventListener('DOMContentLoaded', function() {
            const tooltipElements = document.querySelectorAll('[data-tooltip]');
            tooltipElements.forEach(element => {
                element.addEventListener('mouseenter', function() {
                    showTooltip(this.getAttribute('data-tooltip'));
                });
                element.addEventListener('mouseleave', hideTooltip);
            });
        });
    </script>
</body>
</html>

